<!DOCTYPE html>
<html lang="eng">
<head>
    <meta charset="UTF-8">
    <title>Deadlock Random Build</title>
    <style>
        body {
            background-color: #121212;
            color: #ffffff;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
        }

        h1 {
            color: #fca311;
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: 10px;
        }

        button {
            background-color: #fca311;
            color: #000;
            border: none;
            padding: 15px 50px;
            font-size: 20px;
            font-weight: 800;
            cursor: pointer;
            margin-bottom: 30px;
            border-radius: 5px;
            transition: all 0.2s;
            box-shadow: 0 4px 15px rgba(252, 163, 17, 0.4);
        }

        button:hover {
            background-color: #ffb74d;
            transform: scale(1.05);
        }

        button:disabled {
            background-color: #555;
            cursor: not-allowed;
            transform: none;
        }

        .grid-container {
            display: grid;
            grid-template-columns: repeat(6, 1fr); 
            gap: 10px;
            max-width: 1400px;
            width: 100%;
        }

        .item-card {
            background-color: #1e1e1e;
            border: 1px solid #333;
            border-radius: 6px;
            padding: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            height: 130px;
            justify-content: center;
            position: relative;
            overflow: hidden;
            transition: transform 0.2s;
        }

        .item-card:not(.shuffling):hover {
            border-color: #fca311;
            transform: translateY(-5px);
            z-index: 10;
        }

        .item-image {
            width: 70px;
            height: 70px;
            object-fit: contain;
            margin-bottom: 8px;
            transition: filter 0.1s;
        }

        .item-name {
            font-size: 13px;
            font-weight: 500;
            line-height: 1.2;
        }

        .shuffling .item-image {
            filter: blur(2px) grayscale(0.5);
            transform: scale(0.9);
        }
        .shuffling .item-name {
            opacity: 0.5;
        }

        .type-weapon { border-bottom: 3px solid #ff4d4d; }
        .type-vitality { border-bottom: 3px solid #4dff4d; }
        .type-spirit { border-bottom: 3px solid #bf4dff; }

    </style>
</head>
<body>
    <h1>Deadlock Random Build</h1>
    <button id="spinBtn" onclick="startRoulette()">SPIN!</button>
    
    <div id="buildGrid" class="grid-container"></div>

    <script>
        const itemsDatabase = {
            weapon: [
            "Extended Magazine", "Close Quarters", "Headshot Booster", 
            "High Velocity Rounds", "Monster Rounds", "Rapid Rounds", "Restorative Shot",
            "Active Reload", "Backstabber", "Fleetfoot", "Kinetic Dash", "Intensifying Magazine", "Opening Rounds", "Slowing Bullets",
            "Long Range", "Melee Charge", "Mystic Shot", 
            "Spirit Shredder Bullets", "Swift Striker", "Split Shot", "Titanic Magazine", "Weakening Headshot",
            "Burst Fire", "Escalating Resilience", "Headhunter", 
            "Hunters Aura", "Point Blank", 
            "Sharp Shooter", "Tesla Bullets", 
            "Titanic Magazine", "Toxic Bullets",
            "Alchemical Fire", "Berserker", "Blood Tribute", "Cultist Sacrifice", "Express Shot", "Heroic Aura", "Hollow Point",
            "Spirit Zalupa",
            "Crippling Headshot", "Frenzy", "Glass Cannon", 
            "Lucky Shot", "Ricochet", "Silencer", 
            "Spiritual Overflow", "Armor Piercing Rounds", "Capacitor", "Crushing Fists", "Shadow Weave", "Spell Slinger"
        ],
        vitality: [
            "Extra Health", "Extra Regen", "Sprint Boots", "Healing Rite",
            "Enduring Speed", "Reactive Barrier", "Debuff Reducer", "Bullet Armor",
            "Spirit Armor", "Fortitude", "Lifestrike", "Rescue Beam",
            "Colossus", "Unstoppable", "Inhibitor", "Phantom Strike"
        ],
        spirit: [
            "Extra Charge", "Extra Spirit", "Mystic Burst", "Spirit Strike",
            "Cold Front", "Decay", "Withering Whip", "Slowing Hex",
            "Duration Extender", "Improved Reach", "Silence Wave", "Surge of Power",
            "Boundless Spirit", "Diviner's Kevlar", "Escalating Exposure", "Refresher"
        ]
        };

        let allItemsPool = [];

        const lauchSound = new Audio('start.mp3')
        const tickSound = new Audio('tick.mp3'); 
        tickSound.volume = 0.001;

        function playTick() {
            const soundClone = tickSound.cloneNode();
            soundClone.play().catch(e => console.log("Браузер заблокировал авто-звук", e));
        }

        function initPool() {
            allItemsPool = [];
            itemsDatabase.weapon.forEach(name => allItemsPool.push({ name, type: 'weapon', suffix: '.png' }));
            itemsDatabase.vitality.forEach(name => allItemsPool.push({ name, type: 'vitality', suffix: '_sm.webp' }));
            itemsDatabase.spirit.forEach(name => allItemsPool.push({ name, type: 'spirit', suffix: '_sm.webp' }));
        }

        function slugify(text) {
            return text.toLowerCase().replace(/'/g, '').replace(/\s+/g, '_');
        }

        function getRandomItem() {
            return allItemsPool[Math.floor(Math.random() * allItemsPool.length)];
        }

        function getFinalBuild() {
            let pool = [...allItemsPool];
            for (let i = pool.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [pool[i], pool[j]] = [pool[j], pool[i]];
            }
            return pool.slice(0, 12);
        }

        async function startRoulette() {
            lauchSound.play().catch(e => console.log("Браузер заблокировал авто-звук", e));
            initPool();
            const btn = document.getElementById('spinBtn');
            const container = document.getElementById('buildGrid');
            
            btn.disabled = true;
            btn.textContent = "ROLLING...";

            const finalItems = getFinalBuild();

            container.innerHTML = "";
            const cardElements = [];

            for (let i = 0; i < 12; i++) {
                const card = createCardElement();
                container.appendChild(card);
                cardElements.push(card);
            }

            const promises = cardElements.map((card, index) => {
                const stopDelay = 1000 + (index * 150); 
                return spinCard(card, finalItems[index], stopDelay);
            });

            await Promise.all(promises);

            btn.disabled = false;
            btn.textContent = "AGAIN!";
        }

        function createCardElement() {
            const card = document.createElement('div');
            card.className = 'item-card';

            const img = document.createElement('img');
            img.className = 'item-image';
            img.src = 'https://placehold.co/70x70?text=?';

            const title = document.createElement('div');
            title.className = 'item-name';
            title.textContent = "...";

            card.appendChild(img);
            card.appendChild(title);
            return card;
        }

        function spinCard(card, finalItem, duration) {
            return new Promise(resolve => {
                card.classList.add('shuffling');

                const intervalId = setInterval(() => {
                    const randomTempItem = getRandomItem();
                    updateCardContent(card, randomTempItem);
                }, 60);

                setTimeout(() => {
                    clearInterval(intervalId);
                    
                    updateCardContent(card, finalItem);
                    card.classList.remove('shuffling');
                    card.className = `item-card type-${finalItem.type}`;
                    
                    resolve();
                }, duration);
            });
        }

        function updateCardContent(card, item) {
            const img = card.querySelector('.item-image');
            const title = card.querySelector('.item-name');
            const fileName = slugify(item.name);

            img.src = `img/${fileName}${item.suffix}`;
            title.textContent = item.name;

            img.onerror = function() { 
                this.src = 'https://placehold.co/70x70?text=Wait'; 
            };
        }
    </script>
</body>
</html>